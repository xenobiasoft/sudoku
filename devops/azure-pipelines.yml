trigger:
- main

variables:
  - template: variables.yml

pool:
  vmImage: $(vmImageName)

jobs:
  - job: BuildAndTest
    displayName: build and run test
    steps:          
      - task: UseDotNet@2
        displayName: set sdk to .NET 7
        inputs:
          packageType: sdk
          version: "7.0.x"

      - task: DotNetCoreCLI@2
        displayName: dotnet restore
        inputs:
          command: 'restore'
          projects: '**/*.csproj'
          includeNuGetOrg: true
          feedsToUse: "select"
          vstsFeed: $(vstsFeed)
      
      - task: DotNetCoreCLI@2
        displayName: dotnet test
        inputs:
          command: 'test'
          projects: '**/UnitTests.csproj'

      - task: DotNetCoreCLI@2
        displayName: dotnet build
        inputs:
          command: 'build'
          projects: '**/*.csproj'
          arguments: '--configuration Release'
